(function(a){for(var h=!0,c=[],f,q=void 0==localStorage.qplayer?!0:!1,k=void 0==localStorage.qplayer?!1:"true"===localStorage.qplayer?!0:!1,g=0;g<playlist.length;g++){var l=playlist[g];a("#playlist").append('<li class="lib" style="overflow:hidden;"><span style="margin-left: 5px;">'+l.title+'</span><span style="float: right;" class="artist">'+l.artist+"</span></li>")}var e=0,d,v,g=localStorage.qplayer_shuffle_array;k&&void 0!=g&&playlist.length===(c=JSON.parse(g)).length?(e=c[0],f=0,a("#QPlayer .cover").attr("title",
"\u70b9\u51fb\u5173\u95ed\u968f\u673a\u64ad\u653e")):(k=!1,a("#QPlayer .cover").attr("title","\u70b9\u51fb\u5f00\u542f\u968f\u673a\u64ad\u653e"));for(g=l=0;g<playlist.length;g++)l+=a("#playlist li").eq(g).height()+6;if(360<l&&(a("#playlist").css("overflow","auto"),k)){for(l=g=0;l<e;l++)g+=a("#playlist li").eq(l).height()+6;a("#playlist").scrollTop(g)}var r=function(){d.play();isRotate&&(a("#pContent .ssBtn").css("animation","9.8s linear 0s normal none infinite rotate"),a("#pContent .ssBtn").css("animation-play-state",
"running"));a(".playback").addClass("playing");v=setInterval(z,500);isExceedTag()&&(h?(initMarquee(),h=!1):a(".marquee").marquee("resume"))},w=function(){d.pause();a("#pContent .ssBtn").css("animation-play-state","paused");a(".playback").removeClass("playing");clearInterval(v);isExceedTag()&&a(".marquee").marquee("pause")},t=function(b){var c=10>parseInt(b%60)?"0"+parseInt(b%60):parseInt(b%60);a(".timer").html(parseInt(b/60)+":"+c)},z=function(){t(d.currentTime)},m=function(b){track=0>b?e=playlist.length-
1:b>=playlist.length?e=0:b;h=!0;a("audio").remove();x(track);r()},u=function(a){1===a?(++f===c.length&&(f=0),e=c[f]):0===a&&(0>--f&&(f=c.length-1),e=c[f]);m(e)},A=function(){w();d.currentTime=0;k?u(1):e<playlist.length&&m(++e)},y=function(){this.seekable&&this.seekable.length&&this.seekable.end(0)},B=function(){1==autoplay&&r()},x=function(b){var c=playlist[b],e=a("<audio>").html('<source src="'+c.mp3+'"><source src="'+c.ogg+'">').appendTo("#player");a(".cover").html('<img src="'+c.cover+'" alt="'+
c.album+'">');a(".musicTag").html("<strong>"+c.title+'</strong><span> - </span><span class="artist">'+c.artist+"</span>");a("#playlist li").removeClass("playing").eq(b).addClass("playing");d=e[0];d.addEventListener("progress",y,!1);d.addEventListener("durationchange",y,!1);d.addEventListener("canplay",B,!1);d.addEventListener("ended",A,!1)};x(e);a(".playback").on("click",function(){a(this).hasClass("playing")?w():r()});a(".rewind").on("click",function(){k?u(0):m(--e)});a(".fastforward").on("click",
function(){k?u(1):m(++e)});a("#playlist li").each(function(b){a(this).on("click",function(){m(b);if(k)for(var a=0;a<c.length;a++){if(c[a]===b){f=a;break}}else e=b})});a(function(){a("#QPlayer .liebiao,#QPlayer .liebiao").on("click",function(){var b=a("#playlist");!1===b.hasClass("go")?(b.css({"max-height":"360px",transition:"max-height .5s ease"}),b.css("border","1px solid #dedede"),b.addClass("go")):(b.css({"max-height":"0px",transition:"max-height .5s ease"}),b.css("border","0"),b.removeClass("go"))})});
a("#QPlayer .ssBtn").on("click",function(){var b=a("#QPlayer");!1===a(".ssBtn .adf").hasClass("on")?(q&&(setTimeout("showTips('#player .cover','\u70b9\u51fb\u5c01\u9762\u5f00\u542f(\u5173\u95ed)\u968f\u673a\u64ad\u653e', "+function(){setTimeout("showTips('#player .ctrl .musicTag','\u70b9\u51fb\u62d6\u52a8\u6807\u9898\u680f\u5feb\u8fdb(\u5feb\u9000)')",1E3)}+");",500),q=!q,localStorage.qplayer="false"),b.css("transform","translateX(250px)"),a(".ssBtn .adf").addClass("on")):(b.css("transform","translateX(0px)"),
a(".ssBtn .adf").removeClass("on"))});a("#player .cover").on("click",function(){if(k=!k){a("#player .cover").attr("title","\u70b9\u51fb\u5173\u95ed\u968f\u673a\u64ad\u653e");showNotification("\u5df2\u5f00\u542f\u968f\u673a\u64ad\u653e");for(var b=[],d=0;d<playlist.length;d++)b[d]=d;c=shuffle(b);for(b=0;b<c.length;b++)if(c[b]===e){f=b;break}localStorage.qplayer_shuffle_array=JSON.stringify(c)}else a("#player .cover").attr("title","\u70b9\u51fb\u5f00\u542f\u968f\u673a\u64ad\u653e"),showNotification("\u5df2\u5173\u95ed\u968f\u673a\u64ad\u653e"),
localStorage.removeItem("qplayer_shuffle_array");localStorage.qplayer=k});var n,p;a("#player .ctrl .musicTag").mousedown(function(a){n=a.screenX}).mousemove(function(a){1===a.which&&(p=a.screenX,d.currentTime+=Math.round((p-n)/678*100),t(d.currentTime))});a("#player .ctrl .musicTag").bind("touchstart",function(a){n=a.originalEvent.targetTouches[0].screenX}).bind("touchmove",function(a){p=a.originalEvent.targetTouches[0].screenX;d.currentTime+=Math.round((p-n)/678*100);t(d.currentTime)})})(jQuery);
function initMarquee(){$(".marquee").marquee({duration:15E3,gap:50,delayBeforeStart:0,direction:"left",duplicated:!0})}function isExceedTag(){var a=!1;$(".musicTag strong").width()+$(".musicTag span").width()+$(".musicTag .artist").width()>$(".musicTag").width()&&(a=!0);return a}function shuffle(a){for(var h=a.length,c,f;h;)f=Math.floor(Math.random()*h--),c=a[h],a[h]=a[f],a[f]=c;return a}
function showNotification(a){isShowNotification=!0;0<$(".qplayer-notification").length&&($(".qplayer-notification").remove(),clearTimeout(autoClearTimer),clearTimeout(autoShowTimer));$("body").append('<div class="qplayer-notification animation-target"><span class="qplayer-notification-icon">i</span><span class="body" style="box-shadow: rgba(0, 0, 0, 0.0980392) 0px 0px 5px;"><span class="message"></span></span><a class="close" href="#" onclick="closeNotification();return false;">\u00d7</a><div style="clear: both"></div>');
$(".qplayer-notification .message").text(a);var h=$(".qplayer-notification").css({opacity:"0",width:"auto"}).width()+20;$(".qplayer-notification").css({width:"50px",opacity:"1"});autoShowTimer=setTimeout(function(){$(".qplayer-notification").css({width:h,transition:"all .7s ease"});$(".qplayer-notification .close").delay(500).show(0)},1500);autoClearTimer=setTimeout("if ($('.qplayer-notification').length>0) {closeNotification()}",8E3)}
function closeNotification(){isShowNotification=!1;$(".qplayer-notification").css({width:"50px",transition:"all .7s ease"});$(".qplayer-notification .close").delay(500).hide(0);setTimeout(function(){isShowNotification||($(".qplayer-notification").css("opacity","0"),$(".qplayer-notification-icon").css({transform:"scale(0)",transition:"transform .5s ease"}))},1E3);setTimeout(function(){isShowNotification||$(".qplayer-notification").remove()},1500);clearTimeout(autoClearTimer);clearTimeout(autoShowTimer)}
function showTips(a,h,c){$("body").append('<div class="qplayer_tips"><span class="tips_arrow"></span><span class="info" style="display:none">'+h+'</span><button class="tips_button" onclick="removeTips()">\u4e0d\u518d\u63d0\u793a</button></div>');$(".qplayer_tips").css({top:$(a).offset().top-100-30-15,left:$(a).offset().left-28});$(".qplayer_tips").css({height:100,transition:"all .5s ease-in-out"});$(".qplayer_tips .info").delay(500).fadeIn();$(".tips_arrow").css({"border-width":"15px",transition:"all .5s ease-in-out"});
$(".tips_button").css({height:"30px",transition:"all .5s ease-in-out"});void 0!=c&&$(".tips_button").click(c)}function removeTips(){$(".qplayer_tips .info").fadeOut();$(".qplayer_tips").css({height:"0",transition:"all .5s ease-in-out"});$(".tips_arrow").css({"border-width":"0",transition:"all .5s ease-in-out"});$(".tips_button").css({opacity:"0",transition:"all .2s ease-in-out"});setTimeout(function(){$(".qplayer_tips").remove()},500)};